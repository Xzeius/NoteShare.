import e,{createContext as n,useContext as r,useState as t,useReducer as o,useEffect as i,useCallback as u,useMemo as a}from"react";import c from"@kinde-oss/kinde-auth-pkce-js";var s=function(){return s=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},s.apply(this,arguments)};function l(e,n,r,t){return new(r||(r=Promise))((function(o,i){function u(e){try{c(t.next(e))}catch(e){i(e)}}function a(e){try{c(t.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(u,a)}c((t=t.apply(e,n||[])).next())}))}function f(e,n){var r,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(u=0)),u;)try{if(r=1,t&&(o=2&a[0]?t.return:a[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,a[1])).done)return o;switch(t=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,t=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=n.call(e,u)}catch(e){a=[6,e],t=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g={isAuthenticated:!1,isLoading:!0},d=n(s({},g)),h=function(){var e=r(d);if(void 0===e)throw new Error("Oooops! useKindeAuth must be used within a KindeProvider");return e},v={INITIALISED:function(e,n){return s(s({},e),{isAuthenticated:Boolean(n.user),user:n.user,isLoading:!1,error:void 0})},LOGOUT:function(e){return s(s({},e),{isAuthenticated:!1,user:void 0})},ERROR:function(e,n){return s(s({},e),{isLoading:!1,error:n.error})}},p=function(e,n){return v[n.type]?v[n.type](e,n):e};var y=function(){window.history.replaceState({},document.title,window.location.pathname)},w=function(n){var r=n.audience,h=n.scope,v=n.clientId,w=n.children,b=n.domain,m=n.isDangerouslyUseLocalStorage,k=void 0!==m&&m,O=n.redirectUri,I=n.onRedirectCallback,_=void 0===I?y:I,U=n.logoutUri,F=t(),P=F[0],R=F[1],S=o(p,g),T=S[0],E=S[1];i((function(){try{l(void 0,void 0,void 0,(function(){var e;return f(this,(function(n){switch(n.label){case 0:return[4,c({audience:r,scope:h,client_id:v,domain:b,is_dangerously_use_local_storage:k,redirect_uri:O,logout_uri:U,on_redirect_callback:_,_framework:"React",_frameworkVersion:"3.0.28"})];case 1:return e=n.sent(),R(e),[2]}}))}))}catch(e){console.error(e)}return function(){}}),[r,h,v,b,k,O,U]),i((function(){var e=!0;return function(){if(P&&e)try{var n=P.getUser();E({type:"INITIALISED",user:n})}catch(e){console.log(e),E({type:"ERROR",error:"login error"})}}(),function(){e=!1}}),[P]);var L=u((function(e){return P.login(e)}),[P]),x=u((function(e){return P.register(e)}),[P]),A=u((function(){return P.logout()}),[P]),z=u((function(e,n){return P.getClaim(e,n)}),[P]),j=u((function(e,n,r){return P.getFlag(e,n,r)}),[P]),B=u((function(e,n){return P.getBooleanFlag(e,n)}),[P]),C=u((function(e,n){return P.getIntegerFlag(e,n)}),[P]),D=u((function(e,n){return P.getStringFlag(e,n)}),[P]),G=u((function(){return P.getPermissions()}),[P]),K=u((function(e){return P.getPermission(e)}),[P]),N=u((function(){return P.getOrganization()}),[P]),V=u((function(){return P.getUserOrganizations()}),[P]),q=u((function(e){return P.createOrg(e)}),[P]),H=u((function(){return l(void 0,void 0,void 0,(function(){var e,n;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,P.getToken()];case 1:return e=r.sent(),[3,3];case 2:throw n=r.sent(),console.error(n);case 3:return[2,e]}}))}))}),[P]),J=u((function(){return l(void 0,void 0,void 0,(function(){var e,n;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,P.getIdToken()];case 1:return e=r.sent(),[3,3];case 2:throw n=r.sent(),console.error(n);case 3:return[2,e]}}))}))}),[P]),M=u((function(){return P.getUser()}),[P]),Q=a((function(){return s(s({},T),{getToken:H,getIdToken:J,login:L,register:x,logout:A,createOrg:q,getBooleanFlag:B,getClaim:z,getFlag:j,getIntegerFlag:C,getPermissions:G,getPermission:K,getOrganization:N,getStringFlag:D,getUserOrganizations:V,getUser:M})}),[T,H,J,L,x,A,q,z,G,K,N,V,M]);return e.createElement(d.Provider,{value:Q},w)};export{w as KindeProvider,h as useKindeAuth};
//# sourceMappingURL=kinde-auth-react.esm.js.map
